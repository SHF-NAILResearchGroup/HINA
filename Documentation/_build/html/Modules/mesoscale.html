<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>mesoscale &mdash; HINA  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=85c9c9ec" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="visualization" href="visualization.html" />
    <link rel="prev" title="dyad" href="dyad.html" />
<meta name="google-site-verification" content="3l7OZw91tYxNz06CwcXcnLpSpus8NPIqopuAM_wWi3M" />
 

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            HINA
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Installation and Contributing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation Steps</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Guidelines for Contributing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Modules</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="individual.html">individual</a></li>
<li class="toctree-l1"><a class="reference internal" href="dyad.html">dyad</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">mesoscale</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#tutorial">Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id1">mesoscale</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#reference">Reference</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#demo">Demo</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#example-code">Example Code</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-output">Example Output</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#paper-source">Paper Source</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="visualization.html">visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="dashboard.html">Dashboard</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">HINA</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">mesoscale</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/Modules/mesoscale.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="mesoscale">
<h1>mesoscale<a class="headerlink" href="#mesoscale" title="Link to this heading"></a></h1>
<section id="tutorial">
<h2>Tutorial<a class="headerlink" href="#tutorial" title="Link to this heading"></a></h2>
<p>The <cite>mesoscale</cite> module provides methods for clustering one set of nodes in a heterogeneous interaction network based on their shared interactions with nodes in another node set. The clustering methods employed automatically learn the number of clusters from the heterogeneity in the interaction data to find the mesoscale representation.</p>
<p>New package contributions can incorporate other algorithms for understanding the mesoscale structure of interaction networks.</p>
<p>Currently, the module contains the <cite>clustering.py</cite> file, which includes:</p>
<ul class="simple">
<li><p><cite>bipartite_communities</cite>: Identifies communities in a bipartite network by optimizing a Minimum Description Length (MDL) objective that modifies the microcanonical stochastic block model for the intended clustering task.</p></li>
</ul>
<p>The MDL bipartite community detection method bipartite_communities (custom developed for the HINA package) finds a community partition of the nodes in the first node set using an information theoretic objective function that automatically selects for the optimal number of clusters. This objective scores a partition of the nodes according to how well it allows for the transmission of the bipartite graph while exploiting redundancies in the edges coming from members of the same community. It develops a description length objective by breaking the information transmission process into three steps: (1) Transmit community labels of nodes in the first set; (2) Transmit total edge weight contributions from each of the communities; (3) Transmit weights of each edge from Set 1 to Set 2 (the graph) given the constraints imposed by (1) and (2). Following these steps, the objective we use is:</p>
<div class="math">
<p><img src="../_images/math/674a823bdafc728c6a8eb2a9659fdc1253a2a50b.png" alt="\mathcal{L}(b) = \log N_1 + \log {N_1-1\choose B-1} + \log {N_1\choose n_1,...,n_B} + \log{BN_2+W-1\choose W} + \sum_{r=1}^{B}\sum_{j=1}^{N_2} \log{n_r+w_{rj}-1\choose w_{rj}},"/></p>
</div><dl class="simple">
<dt>where:</dt><dd><ul class="simple">
<li><p><img class="math" src="../_images/math/81fd53e6581e5b3c11e478b6ad951efbc637fc3d.png" alt="b" style="vertical-align: 0px"/> is a partition of the nodes in the first node set into <img class="math" src="../_images/math/d52bc158b323665bd9146513b7e223dd04fd992e.png" alt="B" style="vertical-align: 0px"/> non-empty communities such that <img class="math" src="../_images/math/b6ff1ba7a60788dbb34893500c664fff88a481f4.png" alt="b_i" style="vertical-align: -3px"/> is the community of node <img class="math" src="../_images/math/0a6fd4097836e81202e1394f03a2d94b94186000.png" alt="i" style="vertical-align: 0px"/></p></li>
<li><p><img class="math" src="../_images/math/0f80230be73036ab2ab669ad86f5395c31740e85.png" alt="N_1" style="vertical-align: -3px"/> and <img class="math" src="../_images/math/461f7f656deec16b892e842c031c1a979112bab4.png" alt="N_2" style="vertical-align: -3px"/> are the sizes of the first node set and second node set respectively</p></li>
<li><p><img class="math" src="../_images/math/2655e0f334ddd2f7cd7b088a2fed06c4b6401227.png" alt="n_r" style="vertical-align: -3px"/> is the size of community <img class="math" src="../_images/math/1c19f1c37b865bcf88f7a7af173a51b06d66a1b7.png" alt="r \in \{1, \dots, B\}" style="vertical-align: -5px"/></p></li>
<li><p><img class="math" src="../_images/math/7c620d11a09b8c505052cd3f20c8e8e4c2e4dec2.png" alt="W" style="vertical-align: 0px"/> is the total weight of the edges in the bipartite graph</p></li>
<li><p><img class="math" src="../_images/math/1e25c65ed4c00523ae36446bf1612940d01c1a1c.png" alt="w_{rj}" style="vertical-align: -6px"/> is the total weight of the edges from nodes in community <img class="math" src="../_images/math/2ad3e4239bf0a092abb2c27a757f25753004532c.png" alt="r" style="vertical-align: 0px"/> to node <img class="math" src="../_images/math/027c303e9f184742310cc02b05e714082c6c1355.png" alt="j" style="vertical-align: -4px"/> in the second node set</p></li>
</ul>
</dd>
</dl>
<p>The method optimizes this MDL objective approximately using a fast agglomerative scheme in which we start with every node in its own cluster and iteratively merge the pair of communities that produces the greatest decrease to the description length until all nodes are grouped together. Afterwards, we scan over all solution candidates to identify the MDL-optimal partition.</p>
<p>Inputs for bipartite_communities:</p>
<ul class="simple">
<li><p><strong>G</strong>: A bipartite network represented as a set of tuples <img class="math" src="../_images/math/5aba277b5e5019144f71e62b6a85c1855991c212.png" alt="(i,j,w)" style="vertical-align: -5px"/> representing edge between nodes <img class="math" src="../_images/math/0a6fd4097836e81202e1394f03a2d94b94186000.png" alt="i" style="vertical-align: 0px"/> and <img class="math" src="../_images/math/027c303e9f184742310cc02b05e714082c6c1355.png" alt="j" style="vertical-align: -4px"/> of weight/frequency <img class="math" src="../_images/math/d9d1ad0da1046b97883a1ddee0b20ebe6b65e653.png" alt="w" style="vertical-align: 0px"/>.</p></li>
<li><p><strong>fix_B</strong>: Fixes the number of clusters at specified value (optional, if <cite>None</cite>, the algorithm determines it automatically).</p></li>
</ul>
<p>Outputs include:</p>
<ul class="simple">
<li><p><strong>Cluster labels</strong>: A dictionary mapping nodes to their respective cluster labels.</p></li>
<li><p><strong>Compression ratio</strong>: The description length divided by the naive description length, indicating the effectiveness of the inferred community structure.</p></li>
</ul>
</section>
<section id="id1">
<h2>mesoscale<a class="headerlink" href="#id1" title="Link to this heading"></a></h2>
<p>This module provides methods for detecting mesoscale structures in bipartite interaction networks.</p>
<table class="docutils align-default" id="id4">
<caption><span class="caption-text">Functions</span><a class="headerlink" href="#id4" title="Link to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Function</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference external" href="#bipartite-communities">bipartite_communities(G, fix_B=None)</a></p></td>
<td><p>Identifies bipartite communities by optimizing the MDL objective.</p></td>
</tr>
</tbody>
</table>
<section id="reference">
<h3>Reference<a class="headerlink" href="#reference" title="Link to this heading"></a></h3>
<div id="bipartite-communities" class="function-header">
    <span class="class-name">function</span> <span class="function-name">bipartite_communities(G, fix_B=None)</span>
    <a href="../Code/clustering.html#bipartite-communities" class="source-link">[source]</a>
</div><p><strong>Description</strong>:
Optimizes an MDL objective to find bipartite communities in the network.</p>
<p><strong>Parameters</strong>:</p>
<div class="parameter-block">
    (G, fix_B=None)
</div>

<ul class="parameter-list">
    <li><span class="param-name">G</span>: A weighted edge set represented as tuples <code>(i, j, w_ij)</code>, where <code>w_ij</code> is a positive integer.</li>
    <li><span class="param-name">fix_B</span>: Fixed number of clusters (optional). If <code>None</code>, the number of clusters is learned automatically.</li>
</ul><dl class="simple">
<dt><strong>Returns</strong>:</dt><dd><ul class="simple">
<li><p><strong>dict</strong>: Dictionary mapping nodes to their respective community labels.</p></li>
<li><p><strong>float</strong>: Compression ratio (description length with inferred communities divided by naive description length).</p></li>
</ul>
</dd>
</dl>
</section>
</section>
<section id="demo">
<h2>Demo<a class="headerlink" href="#demo" title="Link to this heading"></a></h2>
<section id="example-code">
<h3>Example Code<a class="headerlink" href="#example-code" title="Link to this heading"></a></h3>
<p>This example demonstrates how to use <cite>bipartite_communities</cite> for clustering nodes in a bipartite network.</p>
<p><strong>Step 1: Import necessary libraries</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">hina.individual</span> <span class="kn">import</span> <span class="n">get_bipartite</span>
<span class="kn">from</span> <span class="nn">hina.mesoscale.clustering</span> <span class="kn">import</span> <span class="n">bipartite_communities</span>
</pre></div>
</div>
<p><strong>Step 2: Define the bipartite graph</strong></p>
<p>We define a bipartite graph based on the <a href="#id2"><span class="problematic" id="id3">`</span></a>synthetic_data_simple’ example file.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;synthetic_data_simple.csv&#39;</span><span class="p">)</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">get_bipartite</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="s1">&#39;student id&#39;</span><span class="p">,</span><span class="s1">&#39;task&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Step 3: Compute bipartite communities using MDL optimization</strong></p>
<p>We identify communities in the bipartite network by minimizing the MDL objective.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">community_labels</span><span class="p">,</span> <span class="n">compression_ratio</span> <span class="o">=</span> <span class="n">bipartite_communities</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Community Labels, B learned:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">community_labels</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Compression Ratio, B learned:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">compression_ratio</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Step 4: Apply clustering with a fixed number of clusters</strong></p>
<p>If desired, we can fix the number of clusters manually.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">community_labels_fixed</span><span class="p">,</span> <span class="n">compression_ratio_fixed</span> <span class="o">=</span> <span class="n">bipartite_communities</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">fix_B</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Community Labels, B=2:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">community_labels_fixed</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Compression Ratio, B=2:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">compression_ratio_fixed</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="example-output">
<h3>Example Output<a class="headerlink" href="#example-output" title="Link to this heading"></a></h3>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Community Labels, B learned:</span>
<span class="go">   {&#39;student_3&#39;: 2, &#39;student_2&#39;: 0, &#39;student_26&#39;: 1, &#39;student_24&#39;: 0, &#39;student_0&#39;: 1, &#39;student_20&#39;: 3, &#39;student_18&#39;: 1, &#39;student_9&#39;: 0, &#39;student_16&#39;: 1, &#39;student_17&#39;: 0, &#39;student_7&#39;: 3, &#39;student_21&#39;: 1, &#39;student_14&#39;: 0, &#39;student_15&#39;: 1, &#39;student_29&#39;: 0, &#39;student_22&#39;: 0, &#39;student_5&#39;: 1, &#39;student_6&#39;: 1, &#39;student_25&#39;: 3, &#39;student_8&#39;: 2, &#39;student_28&#39;: 2, &#39;student_23&#39;: 2, &#39;student_4&#39;: 0, &#39;student_10&#39;: 1, &#39;student_1&#39;: 1, &#39;student_27&#39;: 0, &#39;student_13&#39;: 2, &#39;student_19&#39;: 0, &#39;student_12&#39;: 0, &#39;student_11&#39;: 1}</span>

<span class="go">Compression Ratio, B learned:</span>
<span class="go">   0.7439771231064406</span>

<span class="go">Community Labels, B=2:</span>
<span class="go">   {&#39;student_3&#39;: &#39;Merge_at_Beq_4&#39;, &#39;student_2&#39;: &#39;Merge_at_Beq_3&#39;, &#39;student_26&#39;: &#39;Merge_at_Beq_3&#39;, &#39;student_24&#39;: &#39;Merge_at_Beq_3&#39;, &#39;student_0&#39;: &#39;Merge_at_Beq_3&#39;, &#39;student_20&#39;: &#39;Merge_at_Beq_4&#39;, &#39;student_18&#39;: &#39;Merge_at_Beq_3&#39;, &#39;student_9&#39;: &#39;Merge_at_Beq_3&#39;, &#39;student_16&#39;: &#39;Merge_at_Beq_3&#39;, &#39;student_17&#39;: &#39;Merge_at_Beq_3&#39;, &#39;student_7&#39;: &#39;Merge_at_Beq_4&#39;, &#39;student_21&#39;: &#39;Merge_at_Beq_3&#39;, &#39;student_14&#39;: &#39;Merge_at_Beq_3&#39;, &#39;student_15&#39;: &#39;Merge_at_Beq_3&#39;, &#39;student_29&#39;: &#39;Merge_at_Beq_3&#39;, &#39;student_22&#39;: &#39;Merge_at_Beq_3&#39;, &#39;student_5&#39;: &#39;Merge_at_Beq_3&#39;, &#39;student_6&#39;: &#39;Merge_at_Beq_3&#39;, &#39;student_25&#39;: &#39;Merge_at_Beq_4&#39;, &#39;student_8&#39;: &#39;Merge_at_Beq_4&#39;, &#39;student_28&#39;: &#39;Merge_at_Beq_4&#39;, &#39;student_23&#39;: &#39;Merge_at_Beq_4&#39;, &#39;student_4&#39;: &#39;Merge_at_Beq_3&#39;, &#39;student_10&#39;: &#39;Merge_at_Beq_3&#39;, &#39;student_1&#39;: &#39;Merge_at_Beq_3&#39;, &#39;student_27&#39;: &#39;Merge_at_Beq_3&#39;, &#39;student_13&#39;: &#39;Merge_at_Beq_4&#39;, &#39;student_19&#39;: &#39;Merge_at_Beq_3&#39;, &#39;student_12&#39;: &#39;Merge_at_Beq_3&#39;, &#39;student_11&#39;: &#39;Merge_at_Beq_3&#39;}</span>

<span class="go">Compression Ratio, B=2:</span>
<span class="go">   0.7509732725277739</span>
</pre></div>
</div>
</section>
</section>
<section id="paper-source">
<h2>Paper Source<a class="headerlink" href="#paper-source" title="Link to this heading"></a></h2>
<p>If you use this function in your work, please cite:</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="dyad.html" class="btn btn-neutral float-left" title="dyad" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="visualization.html" class="btn btn-neutral float-right" title="visualization" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Baiyue.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>